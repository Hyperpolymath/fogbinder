= GitHub Repository Protection Rules
:toc: left
:toclevels: 3
:icons: font

== CRITICAL: Bullet-Proof Repository Settings

This document contains the **EXACT** settings you must configure in GitHub's repository settings GUI to make Fogbinder utterly bullet-proof.

'''

== Branch Protection Rules

Navigate to: **Settings â†’ Branches â†’ Branch protection rules â†’ Add rule**

=== Main Branch Protection

**Branch name pattern:** `main`

==== Protect matching branches

âœ… **Require a pull request before merging**

* âœ… Require approvals: **2**
* âœ… Dismiss stale pull request approvals when new commits are pushed
* âœ… Require review from Code Owners
* âœ… Restrict who can dismiss pull request reviews
* âœ… Allow specified actors to bypass required pull requests (leave EMPTY)
* âœ… Require approval of the most recent reviewable push

âœ… **Require status checks to pass before merging**

* âœ… Require branches to be up to date before merging
* **Required status checks (select ALL):**
  - [ ] `test` - Test suite
  - [ ] `quality / Code Quality` - Linting, formatting, type-check
  - [ ] `security / Security Scan` - Security audit
  - [ ] `rsr-compliance / RSR Rhodium Compliance` - RSR verification
  - [ ] `accessibility / Accessibility Check` - Accessibility compliance
  - [ ] `documentation / Documentation Check` - Docs verification
  - [ ] `philosophy / Philosophical Integrity` - Philosophy check
  - [ ] `benchmarks / Performance Benchmarks` - Performance tests

âœ… **Require conversation resolution before merging**

âœ… **Require signed commits**

âœ… **Require linear history**

âœ… **Require merge queue**

* Merge method: **Squash**
* Build concurrency: **5**
* Minimum number of pull requests: **1**
* Maximum waiting time: **60 minutes**

âœ… **Require deployments to succeed before merging** (if applicable)

âŒ **Do not allow bypassing the above settings**

âŒ **Do not allow force pushes**

âŒ **Do not allow deletions**

==== Rules applied to everyone including administrators

âœ… **Include administrators**

==== Restrict who can push to matching branches

âœ… **Restrict pushes that create matching branches**

* Leave empty (no one can push directly)

'''

== Repository Security Settings

Navigate to: **Settings â†’ Security**

=== Code security and analysis

âœ… **Dependency graph** - Enabled

âœ… **Dependabot alerts** - Enabled

âœ… **Dependabot security updates** - Enabled

âœ… **Secret scanning** - Enabled

* âœ… **Secret scanning push protection** - Enabled

âœ… **Code scanning** - Configure CodeQL

==== CodeQL Configuration

* âœ… **Default setup**
* Languages: **JavaScript**, **Rust**
* Query suite: **Extended**

'''

== Actions Permissions

Navigate to: **Settings â†’ Actions â†’ General**

=== Actions permissions

â—‰ **Allow all actions and reusable workflows**

(We need this for GitHub Actions CI/CD)

=== Workflow permissions

â—‰ **Read repository contents and packages permissions**

âœ… **Allow GitHub Actions to create and approve pull requests** - DISABLED

'''

== Secrets and Variables

Navigate to: **Settings â†’ Secrets and variables â†’ Actions**

=== Repository secrets

**None required** (Fogbinder has no external dependencies or API keys)

If deploying to production, add:

* `ZOTERO_PLUGIN_REGISTRY_TOKEN` (if publishing to Zotero)

'''

== Rulesets (New GitHub Feature)

Navigate to: **Settings â†’ Rules â†’ Rulesets â†’ New ruleset â†’ New branch ruleset**

=== RSR Rhodium Compliance Ruleset

**Ruleset name:** `RSR Rhodium Enforcement`

**Enforcement status:** âœ… Active

**Target branches:**

* Include by pattern: `main`, `claude/*`

==== Rules

===== Restrict creations

âœ… Enabled

===== Restrict updates

âœ… Enabled

* âœ… Require linear history
* âœ… Require signed commits

===== Restrict deletions

âœ… Enabled

===== Require status checks to pass

âœ… Enabled

**Status checks:**

* [ ] `test`
* [ ] `quality / Code Quality`
* [ ] `security / Security Scan`
* [ ] `rsr-compliance / RSR Rhodium Compliance`
* [ ] `accessibility / Accessibility Check`
* [ ] `documentation / Documentation Check`
* [ ] `philosophy / Philosophical Integrity`

===== Block force pushes

âœ… Enabled

===== Require pull request before merging

âœ… Enabled

* Required approvals: **2**
* Dismiss stale reviews: âœ…
* Require review from code owners: âœ…
* Require approval of most recent push: âœ…

'''

== Required Status Checks (Details)

=== test

**Job:** `.github/workflows/ci.yml` - `test`

**What it checks:**

* ReScript compilation
* WASM module compilation
* Deno test suite execution
* Test coverage â‰¥80%

**Must pass:** âœ… YES

=== quality / Code Quality

**Job:** `.github/workflows/ci.yml` - `quality`

**What it checks:**

* Deno linting (`deno lint`)
* Code formatting (`deno fmt --check`)
* ReScript type checking (`rescript build`)

**Must pass:** âœ… YES

=== security / Security Scan

**Job:** `.github/workflows/ci.yml` - `security`

**What it checks:**

* Security audit (`just security-audit`)
* TruffleHog secret scanning
* Git SSH verification
* NO TypeScript files exist
* NO package.json exists

**Must pass:** âœ… YES

=== rsr-compliance / RSR Rhodium Compliance

**Job:** `.github/workflows/ci.yml` - `rsr-compliance`

**What it checks:**

* `just verify-rsr` - Full RSR Rhodium verification
* Documentation requirements
* Build system requirements (justfile, no npm)
* Licensing requirements

**Must pass:** âœ… YES

=== accessibility / Accessibility Check

**Job:** `.github/workflows/ci.yml` - `accessibility`

**What it checks:**

* `just a11y` - WCAG 2.1 Level AA compliance
* No `outline: none` in CSS
* No disabled focus outlines
* Keyboard navigation support

**Must pass:** âœ… YES

=== documentation / Documentation Check

**Job:** `.github/workflows/ci.yml` - `documentation`

**What it checks:**

* All required .adoc files exist
* NO .md files except exceptions
* NO TypeScript files exist
* NO package.json exists
* CHANGELOG.adoc updated (for PRs)

**Must pass:** âœ… YES

=== philosophy / Philosophical Integrity

**Job:** `.github/workflows/ci.yml` - `philosophy`

**What it checks:**

* `just philosophy` verification
* Wittgenstein references present
* Austin references present
* Language game concepts intact

**Must pass:** âœ… YES

=== benchmarks / Performance Benchmarks

**Job:** `.github/workflows/ci.yml` - `benchmarks`

**What it checks:**

* `just bench` - Performance benchmarks
* No performance regressions
* Results saved to artifacts

**Must pass:** âš ï¸ INFORMATIONAL (doesn't block)

'''

== Merge Queue Settings

Navigate to: **Settings â†’ Code and automation â†’ Merge queue**

âœ… **Enable merge queue for main branch**

**Settings:**

* Merge method: **Squash and merge**
* Maximum queue size: **5**
* Maximum CI runtime: **60 minutes**
* Minimum time in queue: **5 minutes**
* Status check timeout: **60 minutes**

'''

== Collaborators and Teams

Navigate to: **Settings â†’ Collaborators and teams**

=== Base permissions

**Base role:** `Read`

(Contributors must fork and submit PRs)

=== Teams

**@fogbinder/core** (if organization):

* Permission: `Maintain`
* Members: Core maintainers only

**@fogbinder/reviewers** (if organization):

* Permission: `Write`
* Members: Trusted reviewers

'''

== Advanced Security Features

=== Code owners

Create `.github/CODEOWNERS`:

[source]
----
# RSR Rhodium Standard enforcement
# All changes require review from code owners

# Default owners for everything
* @Hyperpolymath

# Critical files require extra scrutiny
justfile @Hyperpolymath
fogbinder.ncl @Hyperpolymath
.github/workflows/ @Hyperpolymath
src/wasm/ @Hyperpolymath

# Security files
security/ @Hyperpolymath
SECURITY.md @Hyperpolymath
.git/hooks/ @Hyperpolymath

# Documentation
*.adoc @Hyperpolymath
LICENSE_DUAL.adoc @Hyperpolymath
----

=== Auto-link references

Navigate: **Settings â†’ General â†’ Features â†’ Issues â†’ Auto-link references**

**Add reference:**

* Reference prefix: `RSR-`
* Target URL: `https://github.com/Hyperpolymath/fogbinder/blob/main/RSR_RHODIUM_STANDARD_V2.adoc#<num>`

'''

== Notifications

=== Watch settings

For **all collaborators**, recommend:

* âœ… Watch: **All Activity**
* âœ… Get notified: **Pull request reviews**, **Issues**, **Discussions**

'''

== Repository Labels

Navigate: **Issues â†’ Labels**

**Create these labels:**

=== Priority

* `priority: critical` - ğŸ”´ Red - Blocks release
* `priority: high` - ğŸŸ  Orange - Important
* `priority: medium` - ğŸŸ¡ Yellow - Normal
* `priority: low` - ğŸŸ¢ Green - Nice to have

=== Type

* `type: bug` - ğŸ› Red - Something broken
* `type: feature` - âœ¨ Blue - New functionality
* `type: docs` - ğŸ“š Green - Documentation
* `type: security` - ğŸ”’ Red - Security issue
* `type: performance` - âš¡ Yellow - Performance improvement
* `type: rescript` - ğŸŸ¦ Blue - ReScript code
* `type: wasm` - ğŸ¦€ Orange - WASM/Rust code

=== Status

* `status: blocked` - â›” Red - Cannot proceed
* `status: in progress` - ğŸ”„ Blue - Being worked on
* `status: needs review` - ğŸ‘€ Purple - Ready for review
* `status: needs rsr` - ğŸ† Gold - Needs RSR compliance check

=== Philosophy

* `philosophy: wittgenstein` - ğŸ§  Purple - Wittgensteinian concepts
* `philosophy: austin` - ğŸ’¬ Blue - Speech act theory
* `rsr: rhodium` - ğŸ’ Gold - RSR Rhodium compliance

'''

== Repository Topics

Navigate: **Settings â†’ General â†’ Topics**

**Add topics:**

* `zotero`
* `epistemic-ambiguity`
* `philosophy`
* `wittgenstein`
* `rescript`
* `webassembly`
* `deno`
* `post-quantum-cryptography`
* `rsr-rhodium`
* `accessibility`
* `wcag`

'''

== Pre-Commit Checks Automation

=== Require status checks in PRs

**Critical checks that MUST pass:**

1. âœ… **No TypeScript files** (`*.ts`)
2. âœ… **No package.json**
3. âœ… **No node_modules**
4. âœ… **All docs in AsciiDoc** (except exceptions)
5. âœ… **Code formatted** (`deno fmt --check`)
6. âœ… **Code linted** (`deno lint`)
7. âœ… **Tests pass** (`just test`)
8. âœ… **Security audit** (`just security-audit`)
9. âœ… **RSR verification** (`just verify-rsr`)
10. âœ… **Git uses SSH** (not HTTPS)
11. âœ… **Commits signed**
12. âœ… **Conventional commit format**

'''

== Deployment Protection Rules

Navigate: **Settings â†’ Environments**

=== Production Environment

**Environment name:** `production`

==== Protection rules

âœ… **Required reviewers:** 2

âœ… **Wait timer:** 5 minutes

âœ… **Deployment branches:**

* Selected branches only: `main`

'''

== Commit Signature Verification

Navigate: **Settings â†’ SSH and GPG keys**

=== For administrators:

âœ… **Vigilant mode** - Flag unsigned commits

=== Repository setting:

Navigate: **Settings â†’ Branches â†’ Main â†’ Require signed commits**

âœ… **Enabled**

'''

== Final Verification Checklist

After configuring all settings:

* [ ] Branch protection on `main` enabled with 2 required reviews
* [ ] All 8 status checks required
* [ ] Signed commits required
* [ ] Linear history enforced
* [ ] Force pushes blocked
* [ ] Branch deletions blocked
* [ ] Secret scanning enabled with push protection
* [ ] CodeQL scanning enabled
* [ ] Merge queue enabled
* [ ] CODEOWNERS file created
* [ ] Repository topics added
* [ ] Labels created
* [ ] .github/workflows/ci.yml updated and working
* [ ] Git hooks installed locally (pre-commit, pre-push, commit-msg)
* [ ] Salt Robot automation script executable

'''

**Last Updated:** 2025-11-29 +
**RSR Tier:** Rhodium +
**Security Level:** Maximum +
**Automation:** Full
